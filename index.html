<!DOCTYPE html>
<html lang="ur">
<head>
  <meta charset="UTF-8">
  <title>درودِ ابراہیمی کاؤنٹر</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f9f9f9; }
    h1 { color: green; }
    #counter { font-size: 22px; margin: 15px; color: darkblue; }
    #daroodList { margin-top: 20px; max-height: 400px; overflow-y: auto; text-align: right; direction: rtl; }
    .daroodItem { font-size: 14px; margin: 5px; padding: 5px; border-bottom: 1px dashed #aaa; }
    .btn {
      margin: 10px;
      padding: 8px 15px;
      font-size: 16px;
      background: darkblue;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn:hover { background: navy; }
    #resetBtn { background: crimson; }
    #resetBtn:hover { background: darkred; }
  </style>
</head>
<body>
  <h1>🌹 درودِ ابراہیمی کاؤنٹر 🌹</h1>
  <div id="counter">شروع ہو رہا ہے...</div>
  <button id="resetBtn" class="btn">🔄 Reset کریں</button>
  <button id="pdfBtn" class="btn">⬇️ PDF ڈاؤنلوڈ کریں</button>
  <div id="daroodList"></div>

  <script>
    // مکمل درود ابراہیمی
    const daroodText = "اللَّهُمَّ صَلِّ عَلَىٰ مُحَمَّدٍ وَعَلَىٰ آلِ مُحَمَّدٍ كَمَا صَلَّيْتَ عَلَىٰ إِبْرَاهِيمَ وَعَلَىٰ آلِ إِبْرَاهِيمَ إِنَّكَ حَمِيدٌ مَّجِيدٌ. اللَّهُمَّ بَارِكْ عَلَىٰ مُحَمَّدٍ وَعَلَىٰ آلِ مُحَمَّدٍ كَمَا بَارَكْتَ عَلَىٰ إِبْرَاهِيمَ وَعَلَىٰ آلِ إِبْرَاهِيمَ إِنَّكَ حَمِيدٌ مَّجِيدٌ";

    // پچھلا ڈیٹا لوڈ کریں
    let count = localStorage.getItem("daroodCount") 
                ? parseInt(localStorage.getItem("daroodCount")) 
                : 0;

    let daroodList = localStorage.getItem("daroodList") 
                     ? JSON.parse(localStorage.getItem("daroodList")) 
                     : [];

    const counterDiv = document.getElementById("counter");
    const daroodDiv = document.getElementById("daroodList");
    const resetBtn = document.getElementById("resetBtn");
    const pdfBtn = document.getElementById("pdfBtn");

    // Random Color Generator
    function getRandomColor() {
      const colors = ["maroon", "darkgreen", "blue", "purple", "brown", "teal", "darkred", "indigo"];
      return colors[Math.floor(Math.random() * colors.length)];
    }

    function renderDaroodList() {
      daroodDiv.innerHTML = "";
      daroodList.forEach((d, i) => {
        const div = document.createElement("div");
        div.className = "daroodItem";
        div.style.color = getRandomColor();
        div.innerText = (i+1) + ". " + d;
        daroodDiv.appendChild(div);
      });
    }

    function addDarood() {
      count++;
      daroodList.push(daroodText);
      counterDiv.innerText = "اب تک بار: " + count;

      // محفوظ کریں
      localStorage.setItem("daroodCount", count);
      localStorage.setItem("daroodList", JSON.stringify(daroodList));

      renderDaroodList();
    }

    // Reset بٹن
    resetBtn.addEventListener("click", function() {
      if(confirm("کیا آپ واقعی سارا ڈیٹا ری سیٹ کرنا چاہتے ہیں؟")) {
        count = 0;
        daroodList = [];
        localStorage.removeItem("daroodCount");
        localStorage.removeItem("daroodList");
        counterDiv.innerText = "اب تک بار: " + count;
        renderDaroodList();
      }
    });

    // PDF ڈاؤنلوڈ
    pdfBtn.addEventListener("click", function() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFont("Helvetica", "normal");
      doc.setFontSize(10);

      let pageNumber = 1;
      function addHeader() {
        doc.setFontSize(12);
        doc.text("🌹 درود ابراہیمی کاؤنٹر — صفحہ " + pageNumber + " 🌹", 10, 10);
        doc.setFontSize(10);
      }

      addHeader();
      doc.text("کل درود: " + count + " مرتبہ", 10, 20);

      let y = 30;
      daroodList.forEach((d, i) => {
        if(y > 280) { 
          doc.addPage(); 
          pageNumber++;
          addHeader();
          y = 20; 
        }
        const wrappedText = doc.splitTextToSize((i+1) + ". " + d, 180);
        doc.text(wrappedText, 10, y);
        y += (wrappedText.length * 6);
      });

      doc.save("Darood_List.pdf");
    });

    // پہلی بار لسٹ لوڈ کریں
    counterDiv.innerText = "اب تک بار: " + count;
    renderDaroodList();

    // ہر 1 سیکنڈ بعد ایک درود شامل کریں
    setInterval(addDarood, 1000);
  </script>
</body>
</html>
