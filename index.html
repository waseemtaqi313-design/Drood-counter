<!DOCTYPE html>
<html lang="ur">
<head>
  <meta charset="UTF-8">
  <title>درود ابراہیمی کاؤنٹر</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <button onclick="generatePDF()">📄 PDF بنائیں</button>
  <p id="status" style="font-weight:bold; color:green;"></p>

  <script>
    const { jsPDF } = window.jspdf;

    // 🔹 Random Soft رنگ
    function randomSoftColor() {
      return [
        Math.floor(120 + Math.random() * 100),
        Math.floor(120 + Math.random() * 100),
        Math.floor(120 + Math.random() * 100)
      ];
    }

    async function generatePDF() {
      const doc = new jsPDF({ orientation: "portrait", unit: "mm", format: "a4" });
      let pageNumber = 1;
      const statusEl = document.getElementById("status");

      // Header/Footer
      function addHeaderFooter() {
        doc.setFontSize(10);
        doc.setTextColor(80);
        doc.text("درود ابراہیمی - خودکار کاؤنٹر", 105, 10, { align: "center" });
        doc.text("صفحہ " + pageNumber, 200, 290, { align: "right" });
      }

      // Title Page
      const [r1,g1,b1] = randomSoftColor();
      doc.setTextColor(r1,g1,b1);
      doc.setFontSize(22);
      doc.text("درود ابراہیمی", 105, 100, { align: "center" });

      const [r2,g2,b2] = randomSoftColor();
      doc.setTextColor(r2,g2,b2);
      doc.setFontSize(14);
      doc.text("اللّٰهُمَّ صَلِّ عَلٰی مُحَمَّدٍ وَعَلٰی اٰلِ مُحَمَّدٍ، كَمَا صَلَّيْتَ عَلٰی إِبْرَاهِيمَ...", 105, 120, { align: "center" });

      const [r3,g3,b3] = randomSoftColor();
      doc.setTextColor(r3,g3,b3);
      doc.setFontSize(14);
      doc.text("اللّٰهُمَّ بَارِكْ عَلٰی مُحَمَّدٍ وَعَلٰی اٰلِ مُحَمَّدٍ، كَمَا بَارَكْتَ عَلٰی إِبْرَاهِيمَ...", 105, 135, { align: "center" });

      addHeaderFooter();

      // نئی پیج پر لسٹ شروع
      doc.addPage();
      pageNumber++;
      addHeaderFooter();

      // ✅ پورا درود
      const darood = "اللّٰهُمَّ صَلِّ عَلٰی مُحَمَّدٍ وَعَلٰی اٰلِ مُحَمَّدٍ، كَمَا صَلَّيْتَ عَلٰی إِبْرَاهِيمَ وَعَلٰی اٰلِ إِبْرَاهِيمَ، إِنَّكَ حَمِيْدٌ مَّجِيْدٌ۔ اللّٰهُمَّ بَارِكْ عَلٰی مُحَمَّدٍ وَعَلٰی اٰلِ مُحَمَّدٍ، كَمَا بَارَكْتَ عَلٰی إِبْرَاهِيمَ وَعَلٰی اٰلِ إِبْرَاهِيمَ، إِنَّكَ حَمِيْدٌ مَّجِيْدٌ۔";

      const repeatCount = 500; // ← ٹیسٹ کے لیے 500 رکھیں (بعد میں 1000+ کر سکتے ہیں)

      let y = 30;

      for (let i = 0; i < repeatCount; i++) {
        if (y > 270) {
          doc.addPage();
          pageNumber++;
          addHeaderFooter();
          y = 30;
        }

        const [r,g,b] = randomSoftColor();
        doc.setTextColor(r,g,b);

        const wrappedText = doc.splitTextToSize((i+1) + ". " + darood, 180);
        doc.text(wrappedText, 10, y);
        y += (wrappedText.length * 8);

        // Status اپڈیٹ
        if (i % 10 === 0) {
          statusEl.innerText = `ابھی تک ${i+1} درود لکھے جا چکے ہیں...`;
          await new Promise(r => setTimeout(r, 1)); // چھوٹا وقفہ تاکہ براؤزر فریز نہ ہو
        }
      }

      statusEl.innerText = `✅ ${repeatCount} درود مکمل اور PDF تیار ہے!`;
      doc.save("Drood_Ibrahimi.pdf");
    }
  </script>
</body>
</html>
